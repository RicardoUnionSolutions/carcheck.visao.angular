<tab-nav [tabs]="menuPagamento" [(currentTab)]="formaPagamento" [(listaPagamento)]="listaPagamento"></tab-nav>
<div class="p-lg-3 content forma-pagamento-content">
  
  <!-- Placeholder de carregamento -->
  <div *ngIf="cardLoading" class="payment-card-placeholder">
    <div class="loading-overlay">
      <div class="loading-spinner">
        <div class="spinner"></div>
        <p class="loading-text">Carregando forma de pagamento...</p>
      </div>
    </div>
    
    <div class="placeholder-header">
      <div class="placeholder-tabs">
        <div class="placeholder-tab active"></div>
        <div class="placeholder-tab"></div>
        <div class="placeholder-tab"></div>
      </div>
    </div>
    
    <div class="placeholder-card">
      <div class="placeholder-form">
        <div class="placeholder-field large"></div>
        <div class="placeholder-field large"></div>
        <div class="placeholder-field-group">
          <div class="placeholder-field small"></div>
          <div class="placeholder-field small"></div>
        </div>
        <div class="placeholder-field medium"></div>
        <div class="placeholder-checkbox">
          <div class="placeholder-check"></div>
          <div class="placeholder-text"></div>
        </div>
        <div class="placeholder-field medium"></div>
      </div>
      
      <div class="placeholder-card-visual">
        <div class="placeholder-chip"></div>
        <div class="placeholder-lines">
          <div class="placeholder-line"></div>
          <div class="placeholder-line"></div>
          <div class="placeholder-line"></div>
          <div class="placeholder-line"></div>
        </div>
        <div class="placeholder-card-info">
          <div class="placeholder-name"></div>
          <div class="placeholder-date"></div>
        </div>
      </div>
    </div>
    
    <div class="placeholder-payment-info">
      <div class="placeholder-bar"></div>
      <div class="placeholder-item"></div>
    </div>
  </div>

  <!-- Conteúdo real do pagamento -->
  <div *ngIf="!cardLoading">
    <forma-pagamento-credito *ngIf="formaPagamento==0" [valorTotalDesconto]="valorTotalDesconto"
      [valorTotal]="valorTotal"></forma-pagamento-credito>

    <forma-pagamento-boleto *ngIf="formaPagamento==1"></forma-pagamento-boleto>

    <forma-pagamento-pix *ngIf="formaPagamento==2"></forma-pagamento-pix>
  </div>




  <!--<forma-pagamento-debito *ngIf="formaPagamento==2 && bandeirasDebito.length>0" [(activeItem)]="bancoDebito" [(bandeiras)]="bandeirasDebito"  [(pagamento)]="pagamento"></forma-pagamento-debito>-->
</div>

<ng-content></ng-content>

<div class="terms-section">
  <div class="tw-bold custom-checkbox-wrapper">
    <input [(ngModel)]="pagamento.termosUso" class="custom-checkbox" id="inputtermposdeuso" type="checkbox"
      name="inputtermposdeuso">
    <label for="inputtermposdeuso">
      Li e aceito com os
      <u (click)="openModalTermosUso(); $event.preventDefault(); $event.stopPropagation();">
        Termos de uso e Política de Privacidade
      </u>.
    </label>
  </div>
  <div [hidden]="!termosUsoAlert || pagamento.termosUso" class="f-12 text-danger">
    Por favor, leia e concorde com os termos de uso.
  </div>
</div>

<div class="coupon-section">
  <div class="coupon-container">
    <span class="coupon-label">Cupom</span>
    <input class="coupon-input text-uppercase" type="text" [(ngModel)]="cupom" placeholder="Digite o cupom">
    <button *ngIf="!valorDesconto" class="coupon-button"
      (click)="validaCupom()">Ativar</button>
    <button *ngIf="valorDesconto" class="btn btn-sm btn-outline-danger px-2 ml-2"
      (click)="removerCupom()">Remover</button>
  </div>
  <div class="flex-ac">
    <span class="f-12 ml-2 mt-2 mr-2 fw-700 text-success" *ngIf="!cupomError">{{cupomMsg}}</span>
    <span class="f-12 ml-2 mt-2 mr-2 fw-700 text-danger" *ngIf="cupomError">{{cupomMsg}}</span>
  </div>
</div>
<app-modal-termos-uso
  [visible]="mostrarModalTermos"
  (fechar)="closeModalTermosUso($event)"
></app-modal-termos-uso>

